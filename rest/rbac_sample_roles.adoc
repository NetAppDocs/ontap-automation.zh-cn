---
sidebar: sidebar 
permalink: rest/rbac_sample_roles.html 
keywords:  
summary: 根据您的环境、ONTAP RBAC功能可以采用不同的方式使用。下面介绍了一些常见情形。在每种情况下、重点关注特定的安全和管理目标、并提供相应角色定义的示例。 
---
= 角色定义示例
:hardbreaks:
:allow-uri-read: 
:nofooter: 
:icons: font
:linkattrs: 
:imagesdir: ../media/


[role="lead"]
根据您的环境、ONTAP RBAC功能可以采用不同的方式使用。下面介绍了一些常见情形。在每种情况下、重点关注特定的安全和管理目标、并提供相应角色定义的示例。


NOTE: 所有示例均使用`/API/security/roles`和派生的REST端点创建和修改角色。为清晰起见、每个cURL命令都引用一个单独的JSON输入文件。



== 限制对SVM卷操作的访问

您可能希望限制SVM中的存储卷管理。下面的示例说明了这一点、其中一个角色首先创建、然后根据需要进行更新。



=== 创建初始角色

创建了一个传统角色、最初允许访问除克隆之外的所有主要卷管理功能。下面介绍的角色具有以下特定特征：

* 能够执行所有CRUD卷操作、包括获取、创建、修改和删除
* 无法创建卷克隆


.curl 示例
[source, curl]
----
curl --location -i --request POST 'https://10.63.56.136/api/security/roles' -u admin:password -k --header 'Accept: */*' --data @JSONinput
----
.JSON 输入示例
[source, json]
----
{
  "name": "role1",
  "owner": {
    "name": "cluster-1",
    "uuid": "852d96be-f17c-11ec-9d19-005056bbad91"
  },
  "privileges": [
      { "path": "volume create", "access": "all" },
      { "path": "volume delete", "access": "all" }
    ]
}
----


=== 更新角色

可以修改同一角色、以便用户也可以创建卷克隆。

.curl 示例
[source, curl]
----
curl --location -i --request POST 'https://10.63.56.136/api/security/roles/852d96be-f17c-11ec-9d19-005056bbad91/role1/privileges' -u admin:password -k --header 'Accept: */*' --data @JSONinput
----
.JSON 输入示例
[source, json]
----
{
  "path": "volume clone",
  "access": "all"
}
----


== 数据保护管理

在某些情况下、您可能希望为用户提供有限的数据保护功能。下面介绍的传统角色具有以下特征：

* 能够创建和删除快照以及更新SnapMirror关系
* 无法创建或修改更高级别的对象、例如卷或SVM


.curl 示例
[source, curl]
----
curl --location -i --request POST 'https://10.63.56.136/api/security/roles' -u admin:password -k --header 'Accept: */*' --data @JSONinput
----
.JSON 输入示例
[source, json]
----
{
  "name": "role1",
  "owner": {
    "name": "cluster-1",
    "uuid": "852d96be-f17c-11ec-9d19-005056bbad91"
  },
  "privileges": [
      {"path": "volume snapshot create", "access": "all"},
      {"path": "volume snapshot delete", "access": "all"},
      {"path": "volume show", "access": "readonly"},
      {"path": "vserver show", "access": "readonly"},
      {"path": "snapmirror show", "access": "readonly"},
      {"path": "snapmirror update", "access": "all"}
  ]
}
----


== 生成ONTAP 报告

您可以创建REST角色、使用户能够生成ONTAP 报告。下面介绍的角色具有以下特征：

* 能够检索与容量和性能相关的所有存储对象信息(例如卷、qtree、LUN、聚合、节点、 和SnapMirror关系)
* 无法创建或修改更高级别的对象(例如卷或SVM)


.curl 示例
[source, curl]
----
curl --location -i --request POST 'https://10.63.56.136/api/security/roles' -u admin:password -k --header 'Accept: */*' --data @JSONinput
----
.JSON 输入示例
[source, json]
----
{
  "name": "rest_role1",
  "owner": {
    "name": "cluster-1",
    "uuid": "852d96be-f17c-11ec-9d19-005056bbad91"
  },
  "privileges": [
      {"path": "/api/storage/volumes", "access": "readonly"},
      {"path": "/api/storage/qtrees", "access": "readonly"},
      {"path": "/api/storage/luns", "access": "readonly"},
      {"path": "/api/storage/aggregates", "access": "readonly"},
      {"path": "/api/cluster/nodes", "access": "readonly"},
      {"path": "/api/snapmirror/relationships", "access": "readonly"},
      {"path": "/api/svm/svms", "access": "readonly"}
  ]
}
----